<div class="d-flex flex-column h-100 py-3">
    <div class="px-4 mb-4 d-flex align-items-center gap-2">
        <div class="bg-primary rounded p-1 d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
            <i class="bi bi-building-fill text-white small"></i>
        </div>
        <span class="fw-bold fs-5 text-dark tracking-tight">GC INFRA</span>
    </div>

    <nav class="nav nav-pills flex-column px-3 gap-1 flex-grow-1">
        <span class="text-uppercase text-secondary fw-bold px-3 mb-2" style="font-size: 0.75rem; letter-spacing: 1px;">Principal</span>
        
        <a href="#" 
           class="nav-link d-flex align-items-center gap-3 px-3 py-2 rounded-3 fw-medium
           {% if request.resolver_match.url_name == 'home' %}active shadow-sm{% else %}text-secondary hover-bg-light{% endif %}">
            <i class="bi bi-grid"></i>
            <span>Home</span>
        </a>

        {% with url_name=request.resolver_match.url_name %}
        
            <a class="nav-link d-flex align-items-center justify-content-between px-3 py-2 rounded-3 fw-medium text-secondary hover-bg-light cursor-pointer" 
            data-bs-toggle="collapse" 
            href="#submenuEngClinica" 
            role="button" 
            aria-expanded="{% if url_name == 'graficos_eng_clinica' or url_name == 'indicadores_eng_clinica'%}true{% else %}false{% endif %}" 
            aria-controls="submenuEngClinica">
                
                <div class="d-flex align-items-center gap-3">
                    <i class="bi bi-activity {% if url_name == 'graficos_eng_clinica' or url_name == 'indicadores_eng_clinica'%}text-primary{% endif %}"></i>
                    <span class="{% if url_name == 'graficos_eng_clinica' or url_name == 'indicadores_eng_clinica'%}text-primary{% endif %}">Engenharia Clínica</span>
                </div>
                
                <i class="bi bi-chevron-down small transition-icon {% if url_name == 'graficos_eng_clinica' or url_name == 'indicadores_eng_clinica' %}rotate-180{% endif %}"></i>
            </a>

            <div class="collapse {% if url_name == 'graficos_eng_clinica' or url_name == 'indicadores_eng_clinica' %}show{% endif %}" id="submenuEngClinica">
                <nav class="nav nav-pills flex-column mt-1 gap-1">
                    
                    <a href="{% url 'eng_clinica:graficos_eng_clinica' %}" 
                    class="nav-link d-flex align-items-center gap-2 ps-5 py-2 rounded-3 small fw-medium
                    {% if url_name == 'graficos_eng_clinica' %}text-primary bg-primary-subtle{% else %}text-muted hover-bg-light{% endif %}">
                    <i class="bi bi-bar-chart-line"></i>
                    Gráficos
                    </a>

                    <a href="{% url 'eng_clinica:indicadores_eng_clinica' %}" 
                    class="nav-link d-flex align-items-center gap-2 ps-5 py-2 rounded-3 small fw-medium
                    {% if url_name == 'indicadores_eng_clinica' %}text-primary bg-primary-subtle{% else %}text-muted hover-bg-light{% endif %}">
                    <i class="bi bi-pie-chart"></i>
                    Indicadores
                    </a>

                </nav>
            </div>
        {% endwith %}
    </nav>
    
    <div class="mt-auto px-4 pt-3 border-top mx-3">
        <small class="text-muted d-block" style="font-size: 0.7rem;">Versão 1.0.0</small>
        <small class="text-muted" style="font-size: 0.7rem;">&copy; 2026 GC INFRA</small>
    </div>
</div>

<style>
    .hover-bg-light:hover {
        background-color: rgba(0,0,0,0.03);
        color: var(--bs-primary) !important;
    }
    .cursor-pointer {
        cursor: pointer;
    }
    /* Animação da setinha */
    .transition-icon {
        transition: transform 0.2s ease;
    }
    /* Quando o botão do collapse não está 'collapsed', a seta gira */
    a[aria-expanded="true"] .transition-icon {
        transform: rotate(180deg);
    }
    /* Fundo sutil para o item ativo do submenu */
    .bg-primary-subtle {
        background-color: rgba(13, 110, 253, 0.1) !important; 
    }
</style>